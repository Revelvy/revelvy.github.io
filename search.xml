<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Screw å¿«é€Ÿå…¥é—¨</title>
      <link href="/2021/08/05/screw-kuai-su-ru-men/"/>
      <url>/2021/08/05/screw-kuai-su-ru-men/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>å·¥ä½œä¹‹ä½™ï¼Œåœ¨ Github ä¸Šçœ‹åˆ°ä¸€æ¬¾å¼€æºçš„æ•°æ®åº“æ–‡æ¡£ç”Ÿæˆå·¥å…· â€”â€” screwï¼ˆèºä¸é’‰ï¼‰ ã€‚</p><p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬éƒ½è¦ä¸ºåœ¨å„ç§å„æ ·çš„é¡¹ç›®ï¼Œæ‰‹åŠ¨åœ°å»æ•´ç†å’Œç»´æŠ¤æ•°æ®åº“è¡¨ç»“æ„æ–‡æ¡£ï¼Œå½“æ•°æ®åº“è¡¨çš„æ•°é‡ç¹å¤šå¤æ‚ï¼Œäº¦æˆ–æ˜¯æ›´æ”¹å˜åŠ¨å¤šæ—¶ï¼Œæˆ‘ä»¬æ•´ç†å’Œç»´æŠ¤æ–‡æ¡£çš„æ—¶é—´æˆæœ¬å°±ä¼šå˜é«˜ï¼Œé™ä½å·¥ä½œæ•ˆç‡ï¼Œé€ æˆè¯¸å¤šä¸ä¾¿ï¼</p><p>ç°åœ¨ï¼Œscrew è¿™æ¬¾æ’ä»¶å·¥å…·æ¨ªç©ºå‡ºä¸–ï¼Œæ—¨åœ¨å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿè‡ªåŠ¨ç”Ÿæˆæ•°æ®åº“è¡¨ç»“æ„æ–‡æ¡£ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ç®€æ´æ˜“ç”¨ã€è½»é‡ã€æ”¯æŒå¤šç§æ–‡æ¡£æ ¼å¼ï¼ˆHTMLã€Markdownã€Wordï¼‰ã€æ‰©å±•çµæ´»ï¼Œå¯¹å¸‚é¢ä¸Šå¤šç§æ•°æ®åº“ä¹Ÿéƒ½åšäº†æ¯”è¾ƒå¥½çš„æ”¯æŒï¼Œè¯¸å¦‚ï¼šMySQLã€MariaDBã€TIDBã€Oracleã€SqlServerã€PostgreSQL ç­‰ç­‰ï¼Œå…¶ä»–çš„æ­£åœ¨åŠªåŠ›å¼€å‘å½“ä¸­ã€‚</p><p>æ­¤å¤„è´´ä¸Š Github é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/pingfangushi/screw">https://github.com/pingfangushi/screw</a> </p><h2 id="å¿«é€Ÿå…¥é—¨"><a href="#å¿«é€Ÿå…¥é—¨" class="headerlink" title="å¿«é€Ÿå…¥é—¨"></a>å¿«é€Ÿå…¥é—¨</h2><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæ•°æ®åº“è¡¨ç»“æ„æ–‡æ¡£ï¼Œçœ‹çœ‹æ•ˆæœå§ï¼ç›®å‰è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£çš„æœ‰ä¸¤ç§æ–¹å¼ï¼Œç¬¬ä¸€ç§æ–¹å¼æ˜¯åŸºäº Java ä»£ç ï¼Œå¦ä¸€ç§æ–¹å¼æ˜¯åŸºäº Maven æ’ä»¶ã€‚</p><h3 id="åŸºäº-Java-ä»£ç -ï¼ˆ-SpringBoot-é¡¹ç›®ï¼‰"><a href="#åŸºäº-Java-ä»£ç -ï¼ˆ-SpringBoot-é¡¹ç›®ï¼‰" class="headerlink" title="åŸºäº Java ä»£ç  ï¼ˆ SpringBoot é¡¹ç›®ï¼‰"></a>åŸºäº Java ä»£ç  ï¼ˆ SpringBoot é¡¹ç›®ï¼‰</h3><p>é¦–å…ˆï¼Œåœ¨æ•°æ®åº“ä¸­åˆ›å»ºä¸€ä¸ªç”¨äºæµ‹è¯•çš„ user è¡¨ï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">`</span><span class="token keyword">user</span><span class="token punctuation">`</span><span class="token punctuation">;</span><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span><span class="token keyword">user</span><span class="token punctuation">`</span> <span class="token punctuation">(</span>  <span class="token punctuation">`</span>id<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'ç”¨æˆ·ID'</span><span class="token punctuation">,</span>  <span class="token punctuation">`</span>name<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'ç”¨æˆ·å'</span><span class="token punctuation">,</span>  <span class="token punctuation">`</span>pwd<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'ç”¨æˆ·å¯†ç '</span><span class="token punctuation">,</span>  <span class="token punctuation">`</span>perms<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'ç”¨æˆ·æƒé™'</span><span class="token punctuation">,</span>  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'ç”¨æˆ·è¡¨'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ç€ï¼Œå¯¼å…¥ç›¸å…³ä¾èµ–ï¼ˆè‹¥ä¸º SpringBoot é¡¹ç›®ï¼Œå› å…¶è‡ªå¸¦æ•°æ®æºä¸º HikariCP ï¼Œæ•…ä¸å¿…å¯¼å…¥ HikariCP ï¼‰ã€‚</p><p><code>pom.xml</code></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.zaxxer<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>HikariCP<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.freemarker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>freemarker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3.30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬å¯ä»¥æŒ‰ç…§è‡ªåŠ¨ç”Ÿæˆæ•°æ®åº“è¡¨ç»“æ„æ–‡æ¡£çš„å¤§è‡´çš„ä»£ç é€»è¾‘å»å®ç°ï¼Œæœ‰å¦‚ä¸‹ 5 æ­¥ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 1. è·å–æ•°æ®æºï¼ˆç›®å‰ MySQL åªé€‚é…äº† HikariCP æ•°æ®æºï¼Œå°šä¸å…¼å®¹å…¶ä»–æ•°æ®æºæ¯”å¦‚ï¼šDriud ç­‰ï¼Œå‚¬ä¼˜åŒ–~ï¼‰</span><span class="token class-name">DataSource</span> dataSource <span class="token operator">=</span> <span class="token function">getDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 2. è·å–æ–‡æ¡£çš„ç”Ÿæˆé…ç½®ï¼ˆæ–‡æ¡£çš„è¾“å‡ºè·¯å¾„ã€æ–‡ä»¶ç±»å‹ã€è‡ªå®šä¹‰è¾“å‡ºæ–‡ä»¶åç­‰ï¼‰</span><span class="token class-name">EngineConfig</span> engineConfig <span class="token operator">=</span> <span class="token function">getEngineConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 3. è·å–æ–‡æ¡£çš„è¡¨å¤„ç†é…ç½®ï¼ˆæŒ‰æŒ‡å®šæ¡ä»¶ç”Ÿæˆã€å¿½ç•¥è¡¨ï¼‰</span><span class="token class-name">ProcessConfig</span> processConfig <span class="token operator">=</span> <span class="token function">getProcessConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 4. è·å– Screw æ€»é…ç½®ï¼ˆè®¾ç½®æ–‡æ¡£ç‰ˆæœ¬ã€æè¿°ç­‰è¯¦ç»†ä¿¡æ¯ï¼‰</span><span class="token class-name">Configuration</span> config <span class="token operator">=</span> <span class="token function">getScrewConfig</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">,</span> engineConfig<span class="token punctuation">,</span> processConfig<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 5. æ‰§è¡Œç”Ÿæˆ</span><span class="token keyword">new</span> <span class="token class-name">DocumentationExecute</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-è·å–æ•°æ®æº"><a href="#1-è·å–æ•°æ®æº" class="headerlink" title="1. è·å–æ•°æ®æº"></a>1. è·å–æ•°æ®æº</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">DataSource</span> <span class="token function">getDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token class-name">HikariConfig</span> hikariConfig <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HikariConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    hikariConfig<span class="token punctuation">.</span><span class="token function">setDriverClassName</span><span class="token punctuation">(</span><span class="token string">"com.mysql.cj.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    hikariConfig<span class="token punctuation">.</span><span class="token function">setJdbcUrl</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://localhost:3307/mybatis?useSSL=false&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;serverTimezone=GMT%2B8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    hikariConfig<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    hikariConfig<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    hikariConfig<span class="token punctuation">.</span><span class="token function">addDataSourceProperty</span><span class="token punctuation">(</span><span class="token string">"useInformationSchema"</span><span class="token punctuation">,</span> <span class="token string">"true"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    hikariConfig<span class="token punctuation">.</span><span class="token function">setMinimumIdle</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    hikariConfig<span class="token punctuation">.</span><span class="token function">setMaximumPoolSize</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">HikariDataSource</span><span class="token punctuation">(</span>hikariConfig<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-è·å–æ–‡æ¡£çš„ç”Ÿæˆé…ç½®"><a href="#2-è·å–æ–‡æ¡£çš„ç”Ÿæˆé…ç½®" class="headerlink" title="2. è·å–æ–‡æ¡£çš„ç”Ÿæˆé…ç½®"></a>2. è·å–æ–‡æ¡£çš„ç”Ÿæˆé…ç½®</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">EngineConfig</span> <span class="token function">getEngineConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token class-name">EngineConfig</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">//æ–‡æ¡£çš„è¾“å‡ºè·¯å¾„</span>        <span class="token punctuation">.</span><span class="token function">fileOutputDir</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"user.dir"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/doc"</span><span class="token punctuation">)</span>        <span class="token comment">//æ–‡æ¡£ç”Ÿæˆåæ˜¯å¦è‡ªåŠ¨æ‰“å¼€</span>        <span class="token punctuation">.</span><span class="token function">openOutputDir</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>        <span class="token comment">//æ ¼å¼ï¼ˆæ”¯æŒHTMLã€WORDã€MDï¼‰</span>        <span class="token punctuation">.</span><span class="token function">fileType</span><span class="token punctuation">(</span><span class="token class-name">EngineFileType</span><span class="token punctuation">.</span>MD<span class="token punctuation">)</span>        <span class="token comment">//æ¨¡æ¿å®ç°</span>        <span class="token punctuation">.</span><span class="token function">produceType</span><span class="token punctuation">(</span><span class="token class-name">EngineTemplateType</span><span class="token punctuation">.</span>freemarker<span class="token punctuation">)</span>        <span class="token comment">//è‡ªå®šä¹‰è¾“å‡ºæ–‡ä»¶å</span>        <span class="token punctuation">.</span><span class="token function">fileName</span><span class="token punctuation">(</span><span class="token string">"æ•°æ®åº“ç»“æ„æ–‡æ¡£"</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-è·å–æ–‡æ¡£çš„è¡¨å¤„ç†é…ç½®"><a href="#3-è·å–æ–‡æ¡£çš„è¡¨å¤„ç†é…ç½®" class="headerlink" title="3. è·å–æ–‡æ¡£çš„è¡¨å¤„ç†é…ç½®"></a>3. è·å–æ–‡æ¡£çš„è¡¨å¤„ç†é…ç½®</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ProcessConfig</span> <span class="token function">getProcessConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> designatedTableName <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> designatedTablePrefix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> designatedTableSuffix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> ignoreTableName <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">"aa"</span><span class="token punctuation">,</span> <span class="token string">"test_group"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> ignoreTablePrefix <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">"test_"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> ignoreTableSuffix <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">"_test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token class-name">ProcessConfig</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">//æ ¹æ®è¡¨åç”Ÿæˆ</span>        <span class="token punctuation">.</span><span class="token function">designatedTableName</span><span class="token punctuation">(</span>designatedTableName<span class="token punctuation">)</span>        <span class="token comment">//æ ¹æ®è¡¨å‰ç¼€ç”Ÿæˆ</span>        <span class="token punctuation">.</span><span class="token function">designatedTablePrefix</span><span class="token punctuation">(</span>designatedTablePrefix<span class="token punctuation">)</span>        <span class="token comment">//æ ¹æ®è¡¨åç¼€ç”Ÿæˆ</span>        <span class="token punctuation">.</span><span class="token function">designatedTableSuffix</span><span class="token punctuation">(</span>designatedTableSuffix<span class="token punctuation">)</span>        <span class="token comment">//å¿½ç•¥è¡¨å</span>        <span class="token punctuation">.</span><span class="token function">ignoreTableName</span><span class="token punctuation">(</span>ignoreTableName<span class="token punctuation">)</span>        <span class="token comment">//å¿½ç•¥è¡¨å‰ç¼€</span>        <span class="token punctuation">.</span><span class="token function">ignoreTablePrefix</span><span class="token punctuation">(</span>ignoreTablePrefix<span class="token punctuation">)</span>        <span class="token comment">//å¿½ç•¥è¡¨åç¼€</span>        <span class="token punctuation">.</span><span class="token function">ignoreTableSuffix</span><span class="token punctuation">(</span>ignoreTableSuffix<span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4-è·å–-Screw-å®Œæ•´é…ç½®"><a href="#4-è·å–-Screw-å®Œæ•´é…ç½®" class="headerlink" title="4. è·å– Screw å®Œæ•´é…ç½®"></a>4. è·å– Screw å®Œæ•´é…ç½®</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Configuration</span> <span class="token function">getScrewConfig</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">,</span> <span class="token class-name">EngineConfig</span> engineConfig<span class="token punctuation">,</span> <span class="token class-name">ProcessConfig</span> processConfig<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token class-name">Configuration</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">//æ–‡æ¡£ç‰ˆæœ¬</span>        <span class="token punctuation">.</span><span class="token function">version</span><span class="token punctuation">(</span><span class="token string">"1.0.0"</span><span class="token punctuation">)</span>        <span class="token comment">//æ–‡æ¡£æè¿°</span>        <span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">"æ•°æ®åº“è®¾è®¡æ–‡æ¡£ç”Ÿæˆ"</span><span class="token punctuation">)</span>        <span class="token comment">//æ•°æ®æº</span>        <span class="token punctuation">.</span><span class="token function">dataSource</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span>        <span class="token comment">//æ–‡æ¡£çš„ç”Ÿæˆé…ç½®</span>        <span class="token punctuation">.</span><span class="token function">engineConfig</span><span class="token punctuation">(</span>engineConfig<span class="token punctuation">)</span>        <span class="token comment">//æ–‡æ¡£çš„è¡¨å¤„ç†é…ç½®</span>        <span class="token punctuation">.</span><span class="token function">produceConfig</span><span class="token punctuation">(</span>processConfig<span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="5-æ‰§è¡Œç”Ÿæˆ"><a href="#5-æ‰§è¡Œç”Ÿæˆ" class="headerlink" title="5. æ‰§è¡Œç”Ÿæˆ"></a>5. æ‰§è¡Œç”Ÿæˆ</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token class-name">DocumentationExecute</span><span class="token punctuation">(</span><span class="token function">getScrewConfig</span><span class="token punctuation">(</span><span class="token function">getDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getEngineConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getProcessConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ­¤æ—¶ï¼Œåœ¨é¡¹ç›®æ ¹è·¯å¾„çš„ doc æ–‡ä»¶å¤¹ä¸‹å·²ç»ç”Ÿæˆäº†ä¸€ä¸ª user æ•°æ®åº“è¡¨ç»“æ„æ–‡æ¡£äº†ï¼Œå¤§åŠŸå‘Šæˆï¼</p><p><img src="https://cdn.jsdelivr.net/gh/Revelvy/picbed/blog/img/20210805000001.png"></p><h3 id="åŸºäº-Maven-æ’ä»¶"><a href="#åŸºäº-Maven-æ’ä»¶" class="headerlink" title="åŸºäº Maven æ’ä»¶"></a>åŸºäº Maven æ’ä»¶</h3><p>ç¬¬äºŒç§æ–¹å¼ï¼Œæ–‡æ¡£ä¹Ÿæ˜¯è‡ªåŠ¨ç”Ÿæˆåˆ°é¡¹ç›®æ ¹ç›®å½•çš„ doc æ–‡ä»¶å¤¹é‡Œã€‚</p><h4 id="1-å¯¼å…¥ä¾èµ–"><a href="#1-å¯¼å…¥ä¾èµ–" class="headerlink" title="1. å¯¼å…¥ä¾èµ–"></a>1. å¯¼å…¥ä¾èµ–</h4><p><code>pom.xml</code></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.smallbun.screw<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>screw-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.0.18<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>                <span class="token comment">&lt;!--username--&gt;</span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">&gt;</span></span>root<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">&gt;</span></span>                <span class="token comment">&lt;!--password--&gt;</span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">&gt;</span></span>123456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">&gt;</span></span>                <span class="token comment">&lt;!--driver--&gt;</span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>driverClassName</span><span class="token punctuation">&gt;</span></span>com.mysql.cj.jdbc.Driver<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>driverClassName</span><span class="token punctuation">&gt;</span></span>                <span class="token comment">&lt;!--jdbc url--&gt;</span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jdbcUrl</span><span class="token punctuation">&gt;</span></span>jdbc:mysql://localhost:3307/mybatis?useSSL=false<span class="token entity named-entity" title="&amp;">&amp;amp;</span>useUnicode=true<span class="token entity named-entity" title="&amp;">&amp;amp;</span>characterEncoding=utf-8<span class="token entity named-entity" title="&amp;">&amp;amp;</span>serverTimezone=GMT%2B8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jdbcUrl</span><span class="token punctuation">&gt;</span></span>                <span class="token comment">&lt;!--ç”Ÿæˆæ–‡ä»¶ç±»å‹--&gt;</span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileType</span><span class="token punctuation">&gt;</span></span>MD<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileType</span><span class="token punctuation">&gt;</span></span>                <span class="token comment">&lt;!--æ‰“å¼€æ–‡ä»¶è¾“å‡ºç›®å½•--&gt;</span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>openOutputDir</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>openOutputDir</span><span class="token punctuation">&gt;</span></span>                <span class="token comment">&lt;!--ç”Ÿæˆæ¨¡æ¿--&gt;</span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>produceType</span><span class="token punctuation">&gt;</span></span>freemarker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>produceType</span><span class="token punctuation">&gt;</span></span>                <span class="token comment">&lt;!--æ–‡æ¡£åç§° ä¸ºç©ºæ—¶:å°†é‡‡ç”¨[æ•°æ®åº“åç§°-æè¿°-ç‰ˆæœ¬å·]ä½œä¸ºæ–‡æ¡£åç§°--&gt;</span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileName</span><span class="token punctuation">&gt;</span></span>æµ‹è¯•æ–‡æ¡£åç§°<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileName</span><span class="token punctuation">&gt;</span></span>                <span class="token comment">&lt;!--æè¿°--&gt;</span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>æ•°æ®åº“æ–‡æ¡£ç”Ÿæˆ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>                <span class="token comment">&lt;!--ç‰ˆæœ¬--&gt;</span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>                <span class="token comment">&lt;!--æ ‡é¢˜--&gt;</span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>æ•°æ®åº“æ–‡æ¡£<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executions</span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>execution</span><span class="token punctuation">&gt;</span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>phase</span><span class="token punctuation">&gt;</span></span>compile<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>phase</span><span class="token punctuation">&gt;</span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goals</span><span class="token punctuation">&gt;</span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goal</span><span class="token punctuation">&gt;</span></span>run<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goal</span><span class="token punctuation">&gt;</span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goals</span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>execution</span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executions</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-æ‰§è¡Œ-screw-run"><a href="#2-æ‰§è¡Œ-screw-run" class="headerlink" title="2. æ‰§è¡Œ screw:run"></a>2. æ‰§è¡Œ screw:run</h4><p><img src="https://cdn.jsdelivr.net/gh/Revelvy/picbed/blog/img/20210805004012.png"></p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Screw </tag>
            
            <tag> æ•°æ®åº“æ–‡æ¡£ç”Ÿæˆå·¥å…· </tag>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Jedis å¿«é€Ÿå…¥é—¨</title>
      <link href="/2021/01/07/jedis-kuai-su-ru-men/"/>
      <url>/2021/01/07/jedis-kuai-su-ru-men/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><p>Redis å®˜æ–¹ Java å®¢æˆ·ç«¯å¼€å‘åŒ…ã€‚</p><p>ä½œç”¨ï¼šä½¿ç”¨ Java æ“ä½œ Redis ã€‚</p><h2 id="å¿«é€Ÿå…¥é—¨"><a href="#å¿«é€Ÿå…¥é—¨" class="headerlink" title="å¿«é€Ÿå…¥é—¨"></a>å¿«é€Ÿå…¥é—¨</h2><h3 id="one-å¯¼å…¥ä¾èµ–"><a href="#one-å¯¼å…¥ä¾èµ–" class="headerlink" title=":one: å¯¼å…¥ä¾èµ–"></a><span class="github-emoji"><span>1âƒ£</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/0031-20e3.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> å¯¼å…¥ä¾èµ–</h3><p><code>pom.xml</code></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>redis.clients<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jedis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.6.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="two-Linux-Redis-è¿œç¨‹æœåŠ¡ç«¯é…ç½®"><a href="#two-Linux-Redis-è¿œç¨‹æœåŠ¡ç«¯é…ç½®" class="headerlink" title=":two: Linux Redis è¿œç¨‹æœåŠ¡ç«¯é…ç½®"></a><span class="github-emoji"><span>2âƒ£</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/0032-20e3.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> Linux Redis è¿œç¨‹æœåŠ¡ç«¯é…ç½®</h3><p>æœ¬ä¾‹ä½¿ç”¨éƒ¨ç½²åœ¨æœ¬åœ°çš„ CentOS è™šæ‹Ÿæœºæ­å»º Redis æœåŠ¡ï¼Œåœ¨ IDEA æµ‹è¯•è¿æ¥ä¹‹å‰ï¼Œéœ€å¼€å¯ Redis æœåŠ¡å¹¶åšç›¸å…³è®¾ç½®ã€‚</p><blockquote><p>Redis çš„åŸé…ç½®æ–‡ä»¶è·¯å¾„ï¼ˆä¸ä¿®æ”¹ç”¨ä½œå¤‡ä»½ï¼‰ï¼š/opt/redis-5.0.12/redis.conf<br>Redis çš„è‡ªå®šä¹‰é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/usr/local/bin/rconfig/redis.conf</p></blockquote><h4 id="è®¾ç½®å…¬ç½‘æ¥å£ã€å…³é—­ä¿æŠ¤æ¨¡å¼"><a href="#è®¾ç½®å…¬ç½‘æ¥å£ã€å…³é—­ä¿æŠ¤æ¨¡å¼" class="headerlink" title="è®¾ç½®å…¬ç½‘æ¥å£ã€å…³é—­ä¿æŠ¤æ¨¡å¼"></a>è®¾ç½®å…¬ç½‘æ¥å£ã€å…³é—­ä¿æŠ¤æ¨¡å¼</h4><p>Redis é»˜è®¤åªèƒ½ä»æœ¬æœºè®¿é—®ï¼Œæˆ‘ä»¬æƒ³è¦ä»æœ¬åœ°è¿æ¥åˆ°æœåŠ¡å™¨ä¸Šçš„ Redis æœåŠ¡ï¼Œéœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œé¦–å…ˆè®¾ç½® bind ï¼Œbind ç»‘å®šçš„ IP ä¸æ˜¯è¯·æ±‚æ¥æº IP ï¼Œè€Œæ˜¯ Redis ä¸ŠæœåŠ¡å™¨æœ¬èº«æ¥æ”¶è¯·æ±‚çš„ç½‘ç»œæ¥å£çš„ IP ï¼Œæ­¤å¤„è®¾ç½®ç›‘å¬æ¥å£çš„é…ç½®æœ‰ä¸¤ç§æ–¹æ¡ˆï¼šç¬¬ä¸€ç§æ˜¯ç›´æ¥å–æ¶ˆ Redis é»˜è®¤åªèƒ½ä»æœ¬æœºè®¿é—®çš„æ³¨é‡Šï¼Œæ­¤æ—¶å°±å…è®¸äº†æ‰€æœ‰å…¬ç½‘ IP éƒ½å¯ä»¥è¿æ¥è¯¥æœåŠ¡å™¨ä¸Šçš„ Redis æœåŠ¡ã€‚ç¬¬äºŒç§æ˜¯ç»‘å®šå…¬ç½‘æ¥å£ IP ï¼Œè®© Redis åªç›‘å¬ IPv4 çš„æœ¬åœ°å›ç¯æ¥å£å’Œå…¬ç½‘æ¥å£ï¼ˆæ¨èï¼‰ï¼Œç„¶åå…³é—­ Redis çš„ä¿æŠ¤æ¨¡å¼ã€‚</p><p>é’ˆå¯¹ä¸åŒçš„ç¯å¢ƒï¼ŒæŸ¥çœ‹å…¬ç½‘æ¥å£çš„æ–¹å¼æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯ä½¿ç”¨ ifconfig æŸ¥çœ‹å½“å‰æœåŠ¡å™¨çš„ç½‘ç»œæ¥å£ã€‚</p><p><span class="github-emoji"><span>ğŸ“Œ</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f4cc.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> æœ¬æœºè™šæ‹Ÿæœº</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ ifconfigdocker0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500        inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255        inet6 fe80::42:a4ff:fe2a:17fd  prefixlen 64  scopeid 0x20&lt;link&gt;        ether 02:42:a4:2a:17:fd  txqueuelen 0  (Ethernet)        RX packets 101375  bytes 17406789 (16.6 MiB)        RX errors 0  dropped 0  overruns 0  frame 0        TX packets 138351  bytes 372190211 (354.9 MiB)        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0ens33: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500        inet 192.168.34.130  netmask 255.255.255.0  broadcast 192.168.34.255        inet6 fe80::b060:e396:f9fb:f8ee  prefixlen 64  scopeid 0x20&lt;link&gt;        ether 00:0c:29:39:24:89  txqueuelen 1000  (Ethernet)        RX packets 1031326  bytes 1493603587 (1.3 GiB)        RX errors 0  dropped 0  overruns 0  frame 0        TX packets 408748  bytes 39063819 (37.2 MiB)        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536        inet 127.0.0.1  netmask 255.0.0.0        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;        loop  txqueuelen 1000  (Local Loopback)        RX packets 68  bytes 5916 (5.7 KiB)        RX errors 0  dropped 0  overruns 0  frame 0        TX packets 68  bytes 5916 (5.7 KiB)        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0virbr0: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500        inet 192.168.122.1  netmask 255.255.255.0  broadcast 192.168.122.255        ether 52:54:00:30:98:90  txqueuelen 1000  (Ethernet)        RX packets 0  bytes 0 (0.0 B)        RX errors 0  dropped 0  overruns 0  frame 0        TX packets 0  bytes 0 (0.0 B)        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th align="left">ç½‘ç»œæ¥å£</th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td align="left">docker0</td><td align="left">å®‰è£… docker æ—¶è‡ªåŠ¨åˆ›å»ºçš„</td></tr><tr><td align="left">ens33</td><td align="left">è™šæ‹Ÿæœºæ¥å£</td></tr><tr><td align="left">lo</td><td align="left">æœ¬åœ°å›ç¯æ¥å£</td></tr></tbody></table><p>æ­¤æ—¶ Redis é…ç½®æ–‡ä»¶åº”è®¾ç½®ä¸ºï¼š</p><p><code>redis.conf</code></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">bind 127.0.0.1 192.168.34.130protected-mode no<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><span class="github-emoji"><span>ğŸ“Œ</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f4cc.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> â€‹äº‘æœåŠ¡å™¨</p><p><a href="https://blog.csdn.net/HD243608836/article/details/103342436/">https://blog.csdn.net/HD243608836/article/details/103342436/</a></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ ifconfigdocker0   Link encap:Ethernet  HWaddr 3A:F3:20:12:AE:6A          inet addr:192.168.42.1  Bcast:0.0.0.0  Mask:255.255.255.0          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:362879 errors:0 dropped:0 overruns:0 frame:0          TX packets:894703 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0          RX bytes:28218097 (26.9 MiB)  TX bytes:1326305089 (1.2 GiB)eth0      Link encap:Ethernet  HWaddr 00:16:3E:08:18:35          inet addr:10.25.102.37  Bcast:10.25.103.255  Mask:255.255.252.0          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:4958304 errors:0 dropped:0 overruns:0 frame:0          TX packets:2766733 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000          RX bytes:534516269 (509.7 MiB)  TX bytes:13382719049 (12.4 GiB)eth1      Link encap:Ethernet  HWaddr 00:16:3E:08:13:6B          inet addr:120.76.207.156  Bcast:120.76.207.255  Mask:255.255.252.0          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:13183600 errors:0 dropped:0 overruns:0 frame:0          TX packets:14070363 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000          RX bytes:6460933699 (6.0 GiB)  TX bytes:8462002985 (7.8 GiB)lo        Link encap:Local Loopback          inet addr:127.0.0.1  Mask:255.0.0.0          UP LOOPBACK RUNNING  MTU:65536  Metric:1          RX packets:156288093 errors:0 dropped:0 overruns:0 frame:0          TX packets:156288093 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0          RX bytes:19039024606 (17.7 GiB)  TX bytes:19039024606 (17.7 GiB)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th align="left">ç½‘ç»œæ¥å£</th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td align="left">docker0</td><td align="left">å®‰è£… docker æ—¶è‡ªåŠ¨åˆ›å»ºçš„ç½‘æ¡¥</td></tr><tr><td align="left">eth0</td><td align="left">é˜¿é‡Œäº‘å†…ç½‘æ¥å£</td></tr><tr><td align="left">eth1</td><td align="left">é˜¿é‡Œäº‘å…¬ç½‘æ¥å£</td></tr><tr><td align="left">lo</td><td align="left">æœ¬åœ°å›ç¯æ¥å£</td></tr></tbody></table><p>æ­¤æ—¶ Redis é…ç½®æ–‡ä»¶åº”è®¾ç½®ä¸ºï¼š</p><p><code>redis.conf</code></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">bind 127.0.0.1 120.76.207.156protected-mode no<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="é‡å¯-Redis"><a href="#é‡å¯-Redis" class="headerlink" title="é‡å¯ Redis"></a>é‡å¯ Redis</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å¯åŠ¨ Redis æœåŠ¡ç«¯ ï¼ˆé»˜è®¤æ— å¯†ç ï¼‰</span>$ redis-server /usr/local/bin/rconfig/redis.conf<span class="token comment"># æŸ¥çœ‹ Redis è¿›ç¨‹ï¼Œæ£€æŸ¥æ˜¯å¦å¯åŠ¨æˆåŠŸ</span>$ <span class="token function">ps</span> -ef<span class="token operator">|</span><span class="token function">grep</span> redis<span class="token punctuation">[</span>root@localhost bin<span class="token punctuation">]</span><span class="token comment"># ps -ef|grep redis</span>root      <span class="token number">52979</span>      <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">12</span>:39 ?        00:00:00 redis-server <span class="token number">127.0</span>.0.1:6379root      <span class="token number">52994</span>   <span class="token number">3457</span>  <span class="token number">0</span> <span class="token number">12</span>:39 pts/0    00:00:00 <span class="token function">grep</span> --color<span class="token operator">=</span>auto redis<span class="token comment"># åœæ­¢ Redis</span>$ redis-cli -h <span class="token number">127.0</span>.0.1 -p <span class="token number">6379</span> <span class="token function">shutdown</span>$ redis-cli -h <span class="token number">127.0</span>.0.1 -p <span class="token number">6379</span> -a password <span class="token function">shutdown</span>  <span class="token comment"># æœ‰å¯†ç æ—¶ä½¿ç”¨</span><span class="token comment"># å¼€å¯è¿æ¥</span>$ redis-cli -h <span class="token number">127.0</span>.0.1 -p <span class="token number">6379</span>$ redis-cli -h <span class="token function">host</span> -p port -a password  <span class="token comment"># æœ‰å¯†ç æ—¶ä½¿ç”¨</span><span class="token comment"># æµ‹è¯•è¿æ¥ï¼ˆè¿”å› PONG è¡¨ç¤ºè¿æ¥æˆåŠŸï¼‰</span>$ <span class="token function">ping</span><span class="token comment"># é€€å‡ºè¿æ¥</span>$ <span class="token builtin class-name">exit</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="å¼€æ”¾ç«¯å£"><a href="#å¼€æ”¾ç«¯å£" class="headerlink" title="å¼€æ”¾ç«¯å£"></a>å¼€æ”¾ç«¯å£</h4><p><span class="github-emoji"><span>ğŸ“Œ</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f4cc.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> æœ¬æœºè™šæ‹Ÿæœº</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment"># é˜²ç«å¢™å¯åœï¼ˆåœæ‰çš„è¯ï¼Œå°±ä¸éœ€åç»­çš„ç«¯å£æ“ä½œäº†ï¼‰</span>systemctl start/restart/stop firewalld<span class="token comment"># ç«¯å£</span>$ firewall-cmd --list-ports$ firewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span><span class="token number">6379</span>/tcp --permanent$ firewall-cmd --zone<span class="token operator">=</span>public --remove-port<span class="token operator">=</span><span class="token number">6379</span>/tcp --permanent<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><span class="github-emoji"><span>ğŸ“Œ</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f4cc.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> äº‘æœåŠ¡å™¨</p><p>é…ç½®å®‰å…¨ç»„ç­–ç•¥ï¼Œå¼€æ”¾å¯¹åº”ç«¯å£ï¼Œæ­¤å¤„ä¸åšè¿‡å¤šé˜è¿°ã€‚</p><h3 id="three-æµ‹è¯•è¿æ¥"><a href="#three-æµ‹è¯•è¿æ¥" class="headerlink" title=":three:  æµ‹è¯•è¿æ¥"></a><span class="github-emoji"><span>3âƒ£</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/0033-20e3.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>  æµ‹è¯•è¿æ¥</h3><p><code>pom.xml</code></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>fastjson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.2.75<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// æµ‹è¯• Redis è¿æ¥</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">redisTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jedis</span><span class="token punctuation">(</span><span class="token string">"192.168.34.130"</span><span class="token punctuation">,</span><span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jedis<span class="token punctuation">.</span><span class="token function">ping</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">// æµ‹è¯• Redis äº‹åŠ¡</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">redisTransactionTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jedis</span><span class="token punctuation">(</span><span class="token string">"192.168.34.130"</span><span class="token punctuation">,</span> <span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    jedis<span class="token punctuation">.</span><span class="token function">flushDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">JSONObject</span> jsonObject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    jsonObject<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    jsonObject<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"kuangshen"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Transaction</span> multi <span class="token operator">=</span> jedis<span class="token punctuation">.</span><span class="token function">multi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">String</span> result <span class="token operator">=</span> jsonObject<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// jedis.watch(result)</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        multi<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"k1"</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>        multi<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"k2"</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>        multi<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        multi<span class="token punctuation">.</span><span class="token function">discard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jedis<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"k1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// {"name":"kuangshen","hello":"world"}</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jedis<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"k2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// {"name":"kuangshen","hello":"world"}</span>        jedis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
            <tag> Jedis </tag>
            
            <tag> æ•°æ®åº“ </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBoot è‡ªåŠ¨é…ç½®åŸç†</title>
      <link href="/2020/03/05/springboot-zi-dong-pei-zhi-yuan-li/"/>
      <url>/2020/03/05/springboot-zi-dong-pei-zhi-yuan-li/</url>
      
        <content type="html"><![CDATA[<h2 id="SpringBoot-ä¸»é…ç½®ç±»"><a href="#SpringBoot-ä¸»é…ç½®ç±»" class="headerlink" title="SpringBoot ä¸»é…ç½®ç±»"></a>SpringBoot ä¸»é…ç½®ç±»</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬ä» SpringBoot çš„ä¸»é…ç½®ç±»ï¼ˆè¢« <strong>@SpringBootApplication</strong> æ³¨è§£æ ‡æ³¨çš„ç±»ï¼‰å¼€å§‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿›å…¥ @SpringBootApplication æ³¨è§£ï¼Œå¯ä»¥çœ‹åˆ°å…¶ä¸Šæ–¹æœ‰ä¸‰ä¸ªæ³¨è§£ï¼Œåˆ†åˆ«æ˜¯ @SpringBootConfiguration ã€ @EnableAutoConfiguration å’Œ @ComponentScan ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootConfiguration</span><span class="token annotation punctuation">@EnableAutoConfiguration</span><span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span>CUSTOM<span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token class-name">TypeExcludeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span>CUSTOM<span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token class-name">AutoConfigurationExcludeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">SpringBootApplication</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ä¸‹æ¥çš„æˆ‘ä»¬ç€é‡åˆ†æ @EnableAutoConfiguration ã€‚</p><h2 id="å¼€å¯è‡ªåŠ¨é…ç½®"><a href="#å¼€å¯è‡ªåŠ¨é…ç½®" class="headerlink" title="å¼€å¯è‡ªåŠ¨é…ç½®"></a>å¼€å¯è‡ªåŠ¨é…ç½®</h2><p> <strong>@EnableAutoConfiguration</strong> è¿™ä¸ªæ³¨è§£çš„ä½œç”¨æ˜¯ <strong>å¼€å¯è‡ªåŠ¨é…ç½®</strong> ï¼Œæˆ‘ä»¬ç‚¹å¼€å…¶æºç ï¼ˆæœ¬æ–‡ä»…å±•ç¤ºä¸è‡ªåŠ¨é…ç½®ç›¸å…³çš„é‡ç‚¹ä»£ç ï¼‰ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@AutoConfigurationPackage</span><span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">AutoConfigurationImportSelector</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">EnableAutoConfiguration</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰ä¸¤ä¸ªæ³¨è§£ï¼Œåˆ†åˆ«æ˜¯ï¼š@AutoConfigurationPackage å’Œ @Import(AutoConfigurationImportSelector.class)ï¼Œæˆ‘ä»¬æ¥é€ä¸€åˆ†æä¸€ä¸‹å®ƒä»¬å„è‡ªéƒ½åšäº†ä»€ä¹ˆäº‹æƒ…ã€‚</p><h3 id="è‡ªåŠ¨é…ç½®åŒ…"><a href="#è‡ªåŠ¨é…ç½®åŒ…" class="headerlink" title="è‡ªåŠ¨é…ç½®åŒ…"></a>è‡ªåŠ¨é…ç½®åŒ…</h3><p>  <strong>@AutoConfigurationPackage</strong> æ³¨è§£çš„æºç å¦‚ä¸‹ï¼š</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">AutoConfigurationPackages<span class="token punctuation">.</span>Registrar</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">AutoConfigurationPackage</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>  è¿™ä¸ªç±»ä½¿ç”¨ @Import å¯¼å…¥äº† Registrar.class ï¼š</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Registrar</span> <span class="token keyword">implements</span> <span class="token class-name">ImportBeanDefinitionRegistrar</span><span class="token punctuation">,</span> <span class="token class-name">DeterminableImports</span> <span class="token punctuation">{</span><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> metadata<span class="token punctuation">,</span> <span class="token class-name">BeanDefinitionRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token function">register</span><span class="token punctuation">(</span>registry<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">PackageImport</span><span class="token punctuation">(</span>metadata<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPackageName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>  å®ƒåˆ°åº•åšäº†ä»€ä¹ˆå‘¢ï¼Œæˆ‘ä»¬æŠŠ Debug æ–­ç‚¹æ‰“åœ¨æ­¤æ–¹æ³•ä¸Šï¼ŒæŸ¥çœ‹ metadata çš„å€¼ï¼Œå¯å¾—çŸ¥å…¶åŒ…å«äº†ä¸»é…ç½®ç±»çš„ä¿¡æ¯ã€‚</p><p>  <img src="https://cdn.jsdelivr.net/gh/Revelvy/picbed/blog/img/20210804144254.png"></p><p>  é‚£ä¹ˆæ­¤å¤„å°±æ˜¯é€šè¿‡ getPackageName() æ–¹æ³•è·å–ä¸»é…ç½®ç±» Application æ‰€åœ¨çš„åŒ…è·¯å¾„ï¼Œè¿™ä¹Ÿä»ä¾§é¢è¯´æ˜äº†ä¸»é…ç½®ç±»è¦æ”¾åœ¨æœ€å¤–å±‚ç›®å½•çš„åŸå› ã€‚</p><p>  æ‰€ä»¥ï¼Œ@AutoConfigurationPackage è¿™ä¸ªæ³¨è§£çš„ä½œç”¨æ˜¯ <strong>è‡ªåŠ¨é…ç½®åŒ…ï¼Œå³å°†ä¸»é…ç½®ç±»æ‰€åœ¨åŒ…åŠå…¶å­åŒ…ä¸­çš„æ‰€æœ‰ç»„ä»¶æ‰«æåŠ è½½åˆ° Spring å®¹å™¨ä¸­</strong> ã€‚</p><h3 id="è‡ªåŠ¨é…ç½®é€‰æ‹©å™¨"><a href="#è‡ªåŠ¨é…ç½®é€‰æ‹©å™¨" class="headerlink" title="è‡ªåŠ¨é…ç½®é€‰æ‹©å™¨"></a>è‡ªåŠ¨é…ç½®é€‰æ‹©å™¨</h3><p>  <strong>AutoConfigurationImportSelector</strong> çš„æºç å¦‚ä¸‹ï¼š</p><p>  <code>AutoConfigurationImportSelector.java</code></p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">selectImports</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> annotationMetadata<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isEnabled</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> NO_IMPORTS<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token class-name">AutoConfigurationMetadata</span> autoConfigurationMetadata <span class="token operator">=</span> <span class="token class-name">AutoConfigurationMetadataLoader</span><span class="token punctuation">.</span><span class="token function">loadMetadata</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>beanClassLoader<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">AutoConfigurationEntry</span> autoConfigurationEntry <span class="token operator">=</span> <span class="token function">getAutoConfigurationEntry</span><span class="token punctuation">(</span>autoConfigurationMetadata<span class="token punctuation">,</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">toStringArray</span><span class="token punctuation">(</span>autoConfigurationEntry<span class="token punctuation">.</span><span class="token function">getConfigurations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getConfigurations</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>configurations<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">protected</span> <span class="token class-name">AutoConfigurationEntry</span> <span class="token function">getAutoConfigurationEntry</span><span class="token punctuation">(</span><span class="token class-name">AutoConfigurationMetadata</span> autoConfigurationMetadata<span class="token punctuation">,</span><span class="token class-name">AnnotationMetadata</span> annotationMetadata<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isEnabled</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> EMPTY_ENTRY<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token class-name">AnnotationAttributes</span> attributes <span class="token operator">=</span> <span class="token function">getAttributes</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> configurations <span class="token operator">=</span> <span class="token function">getCandidateConfigurations</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">,</span> attributes<span class="token punctuation">)</span><span class="token punctuation">;</span>configurations <span class="token operator">=</span> <span class="token function">removeDuplicates</span><span class="token punctuation">(</span>configurations<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> exclusions <span class="token operator">=</span> <span class="token function">getExclusions</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">,</span> attributes<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">checkExcludedClasses</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span>configurations<span class="token punctuation">.</span><span class="token function">removeAll</span><span class="token punctuation">(</span>exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span>configurations <span class="token operator">=</span> <span class="token function">filter</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> autoConfigurationMetadata<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fireAutoConfigurationImportEvents</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AutoConfigurationEntry</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">protected</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getCandidateConfigurations</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> metadata<span class="token punctuation">,</span> <span class="token class-name">AnnotationAttributes</span> attributes<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> configurations <span class="token operator">=</span> <span class="token class-name">SpringFactoriesLoader</span><span class="token punctuation">.</span><span class="token function">loadFactoryNames</span><span class="token punctuation">(</span><span class="token function">getSpringFactoriesLoaderFactoryClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">getBeanClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notEmpty</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> <span class="token string">"No auto configuration classes found in META-INF/spring.factories. If you "</span><span class="token operator">+</span> <span class="token string">"are using a custom packaging, make sure that file is correct."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> configurations<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>  <code>SpringFactoriesLoader.java</code></p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">loadFactoryNames</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> factoryType<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">ClassLoader</span> classLoader<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token class-name">String</span> factoryTypeName <span class="token operator">=</span> factoryType<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token function">loadSpringFactories</span><span class="token punctuation">(</span>classLoader<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>factoryTypeName<span class="token punctuation">,</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">loadSpringFactories</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">ClassLoader</span> classLoader<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token class-name">MultiValueMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>classLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token class-name">Enumeration</span><span class="token generics"><span class="token punctuation">&lt;</span>URL<span class="token punctuation">&gt;</span></span> urls <span class="token operator">=</span> <span class="token punctuation">(</span>classLoader <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span>                classLoader<span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span>FACTORIES_RESOURCE_LOCATION<span class="token punctuation">)</span> <span class="token operator">:</span>                <span class="token class-name">ClassLoader</span><span class="token punctuation">.</span><span class="token function">getSystemResources</span><span class="token punctuation">(</span>FACTORIES_RESOURCE_LOCATION<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedMultiValueMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>urls<span class="token punctuation">.</span><span class="token function">hasMoreElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token class-name">URL</span> url <span class="token operator">=</span> urls<span class="token punctuation">.</span><span class="token function">nextElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">UrlResource</span> resource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UrlResource</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token class-name">PropertiesLoaderUtils</span><span class="token punctuation">.</span><span class="token function">loadProperties</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">,</span> <span class="token operator">?</span><span class="token punctuation">&gt;</span></span> entry <span class="token operator">:</span> properties<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token class-name">String</span> factoryTypeName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> factoryImplementationName <span class="token operator">:</span> <span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">commaDelimitedListToStringArray</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>factoryTypeName<span class="token punctuation">,</span> factoryImplementationName<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>classLoader<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"Unable to load factories from location ["</span> <span class="token operator">+</span>                FACTORIES_RESOURCE_LOCATION <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">,</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> FACTORIES_RESOURCE_LOCATION <span class="token operator">=</span> <span class="token string">"META-INF/spring.factories"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ¯ä¸ªæ–¹æ³•çš„ä½œç”¨ï¼š</p><p>â€‹    selectImportsï¼šå°†æ‰€éœ€å¯¼å…¥çš„è‡ªåŠ¨é…ç½®ç±»ä»¥å…¨ç±»å xxxAutoConfiguration çš„æ–¹å¼è¿”å›<br>â€‹    getAutoConfigurationEntryï¼šè·å–é…ç½®ç±»å®ä½“<br>   getCandidateConfigurationsï¼šè·å–ç³»ç»Ÿé¢„å…ˆåŠ è½½å¥½çš„å€™é€‰é…ç½®ç±»<br>   loadFactoryNames â€“&gt; loadSpringFactories â€“&gt; FACTORIES_RESOURCE_LOCATION = â€œMETA-INF/spring.factoriesâ€</p></blockquote><p>  spring.factories æ‰€åœ¨è·¯å¾„åŠå…¶éƒ¨åˆ†æºç ï¼š<br> <img src="https://cdn.jsdelivr.net/gh/Revelvy/picbed/blog/img/20210804144255.png"></p>  <pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Auto Configure</span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>admin<span class="token punctuation">.</span>SpringApplicationAdminJmxAutoConfiguration<span class="token punctuation">,</span>\org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>aop<span class="token punctuation">.</span>AopAutoConfiguration<span class="token punctuation">,</span>\<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>  é€šè¿‡ Debug ï¼Œå¯ä»¥çœ‹åˆ°è·å–çš„æ‰€æœ‰çš„å€™é€‰è‡ªåŠ¨é…ç½®ç±»<br>  <img src="https://cdn.jsdelivr.net/gh/Revelvy/picbed/blog/img/20210804144258.png"></p><p>  æ‰€ä»¥ï¼ŒAutoConfigurationImportSelector çš„ä½œç”¨æ˜¯ï¼š <strong>è‡ªåŠ¨é…ç½®é€‰æ‹©å™¨ï¼Œå³ä»è·¯å¾„ â€œMETA-INF/spring.factoriesâ€ ä¸­è·å–ç³»ç»Ÿé¢„å…ˆåŠ è½½å¥½çš„å€™é€‰è‡ªåŠ¨é…ç½®ç±»ï¼Œå°†æ‰€éœ€çš„è‡ªåŠ¨é…ç½®ç±»å¯¼å…¥ Spring å®¹å™¨ã€‚</strong></p><h2 id="è‡ªåŠ¨é…ç½®ç±»çš„ç”Ÿæ•ˆæ¡ä»¶"><a href="#è‡ªåŠ¨é…ç½®ç±»çš„ç”Ÿæ•ˆæ¡ä»¶" class="headerlink" title="è‡ªåŠ¨é…ç½®ç±»çš„ç”Ÿæ•ˆæ¡ä»¶"></a>è‡ªåŠ¨é…ç½®ç±»çš„ç”Ÿæ•ˆæ¡ä»¶</h2><p>ä»‹ç»å®Œ SpringBoot æ˜¯å¦‚ä½•å¯¼å…¥è‡ªåŠ¨é…ç½®ç±»çš„ï¼Œæ¥ä¸‹æ¥å°±æ˜¯åˆ†æè¿™äº›è‡ªåŠ¨é…ç½®ç±»åœ¨ä»€ä¹ˆæƒ…å†µä¸‹æ‰ä¼šç”Ÿæ•ˆï¼Œæˆ‘ä»¬ä»¥è‡ªåŠ¨é…ç½®ç±» WebMvcAutoConfiguration ä¸ºä¾‹ï¼Œå…¶æºç å¦‚ä¸‹ï¼š</p><p><code>WebMvcAutoConfiguration.java</code></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token annotation punctuation">@ConditionalOnWebApplication</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">Type</span><span class="token punctuation">.</span>SERVLET<span class="token punctuation">)</span><span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">Servlet</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">DispatcherServlet</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">WebMvcConfigurer</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span><span class="token class-name">WebMvcConfigurationSupport</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token annotation punctuation">@AutoConfigureOrder</span><span class="token punctuation">(</span><span class="token class-name">Ordered</span><span class="token punctuation">.</span>HIGHEST_PRECEDENCE <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token annotation punctuation">@AutoConfigureAfter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">DispatcherServletAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">TaskExecutionAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token class-name">ValidationAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebMvcAutoConfiguration</span> <span class="token punctuation">{</span><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">EnableWebMvcConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">WebMvcProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">ResourceProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Order</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">WebMvcAutoConfigurationAdapter</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>WebMvcProperties.java</code></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"spring.mvc"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebMvcProperties</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/Revelvy/picbed/blog/img/20210804144257.png" alt="é€šè¿‡ application.yaml è‡ªå®šä¹‰ è‡ªåŠ¨é…ç½®ç±»å±æ€§"></p><p>æ¯ä¸ªè‡ªåŠ¨é…ç½®ç±»çš„ç”Ÿæ•ˆæ¡ä»¶éƒ½å–å†³äº @ConditionalOnxxx æ³¨è§£ï¼Œè¯¦ç»†è¯´æ˜å¦‚å›¾ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/Revelvy/picbed/blog/img/20210804144256.png"></p><p>æ¯ä¸ªè‡ªåŠ¨é…ç½®ç±» xxxAutoConfiguration éƒ½é€šè¿‡é™æ€å†…éƒ¨ç±» xxxAutoConfigurationAdapter ç»‘å®šå¯¹åº”çš„ xxxProperties ï¼ŒxxxProperties é‡ŒåŒ…å«äº†è‡ªåŠ¨é…ç½®ç±»çš„é»˜è®¤å±æ€§å€¼ï¼Œè‹¥æƒ³è‡ªå®šä¹‰å°±éœ€é€šè¿‡è®¾ç½® applicaition.yaml çš„æ–°å±æ€§å€¼è¿›è¡Œè¦†ç›–ã€‚</p><p>ä¾é  SpringBoot çš„è‡ªåŠ¨é…ç½®ç±»ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦å†æ‰‹åŠ¨é…ç½®æ³¨å…¥è¿™äº›ç¹ççš„åŠŸèƒ½ç»„ä»¶äº†ï¼ŒèŠ‚çœäº†å¤§é‡æ—¶é—´ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redis äº‹åŠ¡</title>
      <link href="/2020/01/06/redis-shi-wu/"/>
      <url>/2020/01/06/redis-shi-wu/</url>
      
        <content type="html"><![CDATA[<h3 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h3><p><span class="github-emoji"><span>âš¡</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/26a1.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> Redis äº‹åŠ¡æœ¬è´¨ï¼šä¸€ç»„å‘½ä»¤çš„é›†åˆã€‚</p><p><span class="github-emoji"><span>âš¡</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/26a1.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> Redis å•æ¡å‘½ä»¤å…·æœ‰åŸå­æ€§ï¼Œä½† Redis äº‹åŠ¡æ²¡æœ‰åŸå­æ€§ã€éš”ç¦»æ€§ï¼ˆä¸å­˜åœ¨éš”ç¦»çº§åˆ«ï¼‰ã€‚</p><h3 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h3><p><span class="github-emoji"><span>ğŸŒ </span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f320.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> ä¸€æ¬¡æ€§ï¼šä¸€ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰å¾…æ‰§è¡Œå‘½ä»¤éƒ½ä¼šè¢«ä¸€æ¬¡æ€§æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œå³åºåˆ—åŒ–ã€‚<br><span class="github-emoji"><span>ğŸŒ </span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f320.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> é¡ºåºæ€§ï¼šæŒ‰é¡ºåºæ‰§è¡Œï¼šå…ˆè¿›å…ˆå‡ºã€‚<br><span class="github-emoji"><span>ğŸŒ </span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f320.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> æ’ä»–æ€§ï¼šäº’ä¸å¹²æ‰°ã€‚</p><h3 id="æ‰§è¡Œæµç¨‹"><a href="#æ‰§è¡Œæµç¨‹" class="headerlink" title="æ‰§è¡Œæµç¨‹"></a>æ‰§è¡Œæµç¨‹</h3><p><span class="github-emoji"><span>1âƒ£</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/0031-20e3.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> â€‹å¼€å¯ä¸€ç»„äº‹åŠ¡ï¼šmulti<br><span class="github-emoji"><span>2âƒ£</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/0032-20e3.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> â€‹å‘½ä»¤å…¥é˜Ÿï¼šâ€¦â€¦<br><span class="github-emoji"><span>3âƒ£</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/0033-20e3.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> åºŸå¼ƒè¿™ç»„äº‹åŠ¡ï¼šdiscard<br><span class="github-emoji"><span>4âƒ£</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/0034-20e3.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> â€‹æ‰§è¡Œäº‹åŠ¡ï¼šexec</p><p><code>æ‰§è¡Œä¸€ç»„äº‹åŠ¡</code></p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> multiOK<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> k1 v1QUEUED<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> get k1QUEUED<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">exec</span><span class="token number">1</span><span class="token punctuation">)</span> OK<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v1"</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">keys</span> <span class="token operator">*</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"k1"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>ä¸­é€”åºŸå¼ƒäº‹åŠ¡</code></p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> multiOK<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> k1 v1QUEUED<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> get k1QUEUED<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">discard</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">keys</span> <span class="token operator">*</span><span class="token punctuation">(</span>empty list <span class="token operator">or</span> <span class="token keyword">set</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å¼‚å¸¸"><a href="#å¼‚å¸¸" class="headerlink" title="å¼‚å¸¸"></a>å¼‚å¸¸</h3><h4 id="bug-ç¼–è¯‘æ—¶å¼‚å¸¸"><a href="#bug-ç¼–è¯‘æ—¶å¼‚å¸¸" class="headerlink" title=":bug: ç¼–è¯‘æ—¶å¼‚å¸¸"></a><span class="github-emoji"><span>ğŸ›</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f41b.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> ç¼–è¯‘æ—¶å¼‚å¸¸</h4><p>äº‹åŠ¡ä¸­æœ‰è¯­æ³•é”™è¯¯çš„å‘½ä»¤æ—¶ï¼Œæ‰€æœ‰å‘½ä»¤éƒ½ä¸ä¼šè¢«æ‰§è¡Œ</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> multiOK<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> k1 v1QUEUED<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> getset k1  <span class="token comment"># è¯­æ³•é”™è¯¯çš„å‘½ä»¤</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> ERR wrong number <span class="token keyword">of</span> arguments <span class="token keyword">for</span> <span class="token string">'getset'</span> command<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> k2 v2QUEUED<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">exec</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> EXECABORT <span class="token keyword">Transaction</span> discarded because <span class="token keyword">of</span> previous <span class="token keyword">errors</span><span class="token punctuation">.</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">keys</span> <span class="token operator">*</span><span class="token punctuation">(</span>empty list <span class="token operator">or</span> <span class="token keyword">set</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="bug-è¿è¡Œæ—¶å¼‚å¸¸"><a href="#bug-è¿è¡Œæ—¶å¼‚å¸¸" class="headerlink" title=":bug: è¿è¡Œæ—¶å¼‚å¸¸"></a><span class="github-emoji"><span>ğŸ›</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f41b.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> è¿è¡Œæ—¶å¼‚å¸¸</h4><p>é™¤äº†é”™è¯¯å‘½ä»¤ä¸è¢«æ‰§è¡ŒæŠ›å¼‚å¸¸ä¹‹å¤–ï¼Œå…¶ä»–æ­£ç¡®å‘½ä»¤å¯ä»¥æ­£å¸¸æ‰§è¡Œï¼ˆè¯´æ˜äº† Redis äº‹åŠ¡æ²¡æœ‰åŸå­æ€§ï¼‰</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> multiOK<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> k1 <span class="token string">"v1"</span>QUEUED<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> incr k1  <span class="token comment"># è¯­æ³•æ­£ç¡®ä½†è¿è¡Œæ—¶é”™è¯¯ï¼ˆå­—ç¬¦ä¸²ä¸èƒ½+1ï¼‰</span>QUEUED<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> k2 v2QUEUED<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">exec</span><span class="token number">1</span><span class="token punctuation">)</span> OK<span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> ERR <span class="token keyword">value</span> <span class="token operator">is</span> <span class="token operator">not</span> an <span class="token keyword">integer</span> <span class="token operator">or</span> <span class="token keyword">out</span> <span class="token keyword">of</span> range<span class="token number">3</span><span class="token punctuation">)</span> OK<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">keys</span> <span class="token operator">*</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"k2"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"k1"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç›‘æ§"><a href="#ç›‘æ§" class="headerlink" title="ç›‘æ§"></a>ç›‘æ§</h3><blockquote><p> æ‚²è§‚é”å’Œä¹è§‚é”</p><p> æ‚²è§‚é”ï¼šè®¤ä¸ºä»€ä¹ˆæ—¶å€™éƒ½ä¼šå‡ºé—®é¢˜ï¼Œæ— è®ºåšä»€ä¹ˆéƒ½ä¼šåŠ é”ï¼Œæ€§èƒ½ä½ã€‚</p><p> ä¹è§‚é”ï¼šè®¤ä¸ºä»€ä¹ˆæ—¶å€™éƒ½ä¸ä¼šå‡ºé—®é¢˜ï¼Œæ— è®ºåšä»€ä¹ˆéƒ½ä¸ä¼šåŠ é”ã€‚</p></blockquote><p><strong><code>ä¸åŒåœºæ™¯å®ç°ä¹è§‚é”çš„æ–¹å¼</code></strong></p><p><span class="github-emoji"><span>ğŸ’œ</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f49c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> æ•°æ®åº“ ï¼šç”¨ version å­—æ®µï¼Œå³ä¸ºæ•°æ®å¢åŠ ä¸€ä¸ªç‰ˆæœ¬æ ‡è¯†ï¼ˆå…ˆè·å– version ï¼Œæ›´æ–°æ—¶å†æ¯”è¾ƒ versionï¼‰</p><p><span class="github-emoji"><span>ğŸ’›</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f49b.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>  Redis ï¼šç”¨ watch å®ç°</p><p><span class="github-emoji"><span>1âƒ£</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/0031-20e3.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span><strong><code>ä¸ä½¿ç”¨ watch æ­£å¸¸æ‰§è¡Œäº‹åŠ¡</code></strong></p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> money <span class="token number">100</span>OK<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> <span class="token keyword">out</span> <span class="token number">0</span>OK<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> watch money  <span class="token comment"># ç›‘æ§é’±åŒ…</span>OK<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> multiOK<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> decrby money <span class="token number">2</span>  <span class="token comment"># é’±åŒ…æ‰£é™¤ 2 å—é’±</span>QUEUED<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> incrby <span class="token keyword">out</span> <span class="token number">2</span>  <span class="token comment"># æ€»è®¡èŠ±å‡ºå» 2 å—é’±</span>QUEUED<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">exec</span>  <span class="token comment"># äº‹åŠ¡æ‰§è¡ŒæˆåŠŸåï¼Œä¼šè‡ªåŠ¨å–æ¶ˆç›‘æ§ watch </span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">integer</span><span class="token punctuation">)</span> <span class="token number">98</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">integer</span><span class="token punctuation">)</span> <span class="token number">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><span class="github-emoji"><span>2âƒ£</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/0032-20e3.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span><strong><code>ä½¿ç”¨ watch å®ç°ä¹è§‚é”</code></strong></p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment"># å¼€å¯ç¬¬ä¸€ä¸ªè¿æ¥ï¼ˆçº¿ç¨‹ 1ï¼‰</span>$ redis<span class="token operator">-</span>cli <span class="token operator">-</span>p <span class="token number">6379</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> money <span class="token number">100</span>OK<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> <span class="token keyword">out</span> <span class="token number">0</span>OK<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> watch money  <span class="token comment"># ç›‘æ§é’±åŒ…ã€åŠ ç›‘æ§/åŠ é”ã€‘</span>OK<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> multiOK<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> decrby money <span class="token number">2</span>  <span class="token comment"># é’±åŒ…æ‰£é™¤ 2 å—é’±</span>QUEUED<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> incrby <span class="token keyword">out</span> <span class="token number">2</span>  <span class="token comment"># æ€»è®¡èŠ±å‡ºå» 2 å—é’±</span>QUEUED<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">exec</span>  <span class="token comment"># äº‹åŠ¡æ‰§è¡Œå¤±è´¥ï¼ˆæ‰§è¡Œå‰ï¼Œè¢«çº¿ç¨‹ 2 æ’é˜Ÿä¿®æ”¹äº†å€¼ï¼‰ã€æ¯”å¯¹ç›‘è§†å€¼æ˜¯å¦å˜åŒ–ï¼Œä¸å˜åˆ™æ‰§è¡ŒæˆåŠŸã€‘</span><span class="token punctuation">(</span>nill<span class="token punctuation">)</span><span class="token comment"># è‹¥äº‹åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œå…ˆè§£é™¤ç›‘è§†/è§£é”ï¼Œå†é‡æ–°ç›‘è§†/åŠ é”</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> unwatchOK<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> watchOK<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment"># å¼€å¯ç¬¬äºŒä¸ªè¿æ¥ï¼ˆçº¿ç¨‹ 2ï¼‰</span>$ redis<span class="token operator">-</span>cli <span class="token operator">-</span>p <span class="token number">6379</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> get money<span class="token number">98</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>:<span class="token number">6379</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> money <span class="token number">999</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
            <tag> æ•°æ®åº“ </tag>
            
            <tag> äº‹åŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
